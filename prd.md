# PRD: 장치 연결 및 이벤트 로그 모니터

## 1. 개요

이 문서는 스크립트 실행 시 연결된 하드웨어(COM 포트, 카메라, USB 장치) 정보를 자동으로 수집하고, **Windows 이벤트 뷰어 로그**를 분석하여 **지정된 이벤트(예: 장치 연결 끊김)**의 빈도를 파악하는 파이썬 애플리케이션의 요구사항을 정의합니다.

## 2. 목표

* 장치 상호작용과 관련된 현재 연결된 하드웨어(COM, 카메라, USB)의 개요를 빠르게 제공합니다.
* **Windows 이벤트 뷰어 로그**를 기반으로 특정 시스템 이벤트(특히 연결 끊김 관련)의 빈도를 정량화합니다.
* 스크립트 실행 시 이러한 작업을 자동으로 수행합니다.
* 수집된 정보를 명령줄 콘솔에 직접 출력합니다.

## 3. 기능 명세

### 3.1 자동 실행
* **설명:** 정의된 모든 작업(하드웨어 감지, **이벤트 로그 분석**)은 파이썬 스크립트가 시작될 때 사용자 상호작용 없이 자동으로 실행되어야 합니다.
* **성공 기준:** `python main.py` 실행 시 아래의 모든 기능이 수행되고 결과가 콘솔에 출력됩니다.

### 3.2 하드웨어 정보 추출
* **설명:** 애플리케이션은 시스템(Windows 장치 관리자에 해당)을 쿼리하여 현재 연결된 장치 목록을 가져와야 합니다.
* **세부 사항:**
    * 사용 가능한 COM 포트 목록 (예: COM1, COM3). 가능한 경우 설명 또는 하드웨어 ID 포함.
    * 시스템에서 인식하는 연결된 카메라 목록. 장치 이름 포함.
    * 연결된 USB 장치 목록. 장치 이름 또는 설명 포함.
* **성공 기준:** 스크립트가 감지된 COM 포트, 카메라, USB 장치의 형식을 갖춘 목록을 콘솔에 출력합니다. 정보는 합리적으로 식별 가능해야 합니다.

### 3.3 이벤트 로그 끊김 분석 (수정됨)
* **설명:** 애플리케이션은 **Windows 이벤트 뷰어**의 지정된 로그(예: 'System' 로그)를 쿼리하여, **미리 정의된 이벤트 소스(Source) 또는 이벤트 ID**와 일치하는 이벤트의 발생 횟수를 계산해야 합니다.
* **세부 사항:**
    * **로그 소스:** Windows 이벤트 뷰어의 특정 로그 이름 (기본값: 'System').
    * **이벤트 식별:** **사용자가 지정한** 이벤트 소스 목록 및/또는 이벤트 ID 목록을 기반으로 이벤트를 식별합니다. (예: USB 연결 해제를 나타내는 `Microsoft-Windows-Kernel-PnP` 소스의 이벤트 ID `2102`, 특정 네트워크 어댑터의 링크 다운 이벤트 등). **어떤 종류의 '끊김'을 추적할지에 따라 사용자가 관련 소스/ID를 직접 확인하고 스크립트를 수정해야 합니다.**
    * **출력:** 지정된 기준과 일치하는 이벤트의 총 수를 콘솔에 표시합니다. (예: "지정된 이벤트 ID/소스를 가진 이벤트 발견: 5").
* **성공 기준:** 스크립트가 지정된 Windows 이벤트 로그를 읽고, 정의된 소스/ID 기준과 일치하는 이벤트 수를 계산하여 총 횟수를 출력합니다. 권한 부족 등의 오류는 적절히 보고해야 합니다.

## 4. 비 목표 사항

* 실시간 모니터링 또는 알림 기능.
* 그래픽 사용자 인터페이스 (GUI).
* Windows 외 다른 플랫폼과의 호환성 (WMI 및 이벤트 로그 접근 의존).
* 시스템 설정 또는 장치 상태 변경.
* 고급 이벤트 로그 분석 (예: 시간 기반 빈도 분석, 이벤트 상관관계 분석).

## 5. 기술 요구사항

* **언어:** Python 3.x
* **라이브러리:**
    * `pyserial`: COM 포트 감지용.
    * `WMI`: 카메라 및 USB 장치 감지를 위한 Windows Management Instrumentation 쿼리용.
    * `pywin32`: Windows 이벤트 로그 접근용 (**필수**).
    * 표준 라이브러리 (`os`, `platform`, `collections`).
* **환경:** Windows 운영 체제 (이벤트 로그 접근 및 WMI 사용). **스크립트 실행 시 관리자 권한이 필요할 수 있습니다.**